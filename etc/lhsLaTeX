#!/bin/bash

ROOT="$1"
FILE="$2"
FILE_NAME="${FILE%.*}"
FILE_DIR="`pwd`"

cd $ROOT

if [ ! -d tex-build ]; then mkdir tex-build; fi

cd tex-build

TEX_FILE="$FILE_NAME.tex"
PDF_FILE="$FILE_NAME.pdf"

lhs2TeX -o "$TEX_FILE" "$FILE_DIR/$FILE" > /dev/null

cp "$FILE_DIR"/*.tex .

latex -interaction=nonstopmode "$TEX_FILE"
pdflatex -synctex=1 -interaction=nonstopmode "$TEX_FILE"

PDF_TARGET="$FILE_DIR/$FILE.pdf"
cp "$PDF_FILE" "$PDF_TARGET"


